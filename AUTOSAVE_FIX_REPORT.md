# ğŸ”§ è‡ªå‹•ä¿å­˜ã‚¨ãƒ©ãƒ¼ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆ

## å•é¡Œã®æ¦‚è¦

åŸ·ç­†ç”»é¢ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ç·¨é›†å¾Œã€2ç§’å¾Œã«è‡ªå‹•ä¿å­˜ãŒå®Ÿè¡Œã•ã‚Œã¾ã—ãŸãŒã€ã€Œä¿å­˜ã‚¨ãƒ©ãƒ¼ï¼ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸï¼‰ã€ã¨ã„ã†ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã¾ã—ãŸã€‚

## åŸå› 

è¨˜äº‹ä½œæˆæ™‚ã«ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä¸€æ™‚çš„ã«ç”Ÿæˆã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸãŒã€å®Ÿéš›ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ä¿å­˜ã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ã¯ã€SupabaseãŒè‡ªå‹•ç”Ÿæˆã—ãŸæ–°ã—ã„IDãŒå‰²ã‚Šå½“ã¦ã‚‰ã‚Œã¦ã„ã¾ã—ãŸã€‚

ãã®ãŸã‚ã€è‡ªå‹•ä¿å­˜æ™‚ã«ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒæŒã£ã¦ã„ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã¨ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å†…ã®å®Ÿéš›ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³IDãŒä¸€è‡´ã›ãšã€ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã®æ›´æ–°ã«å¤±æ•—ã—ã¦ã„ã¾ã—ãŸã€‚

### å•é¡Œã®æµã‚Œ

1. **ç›®æ¬¡ç”Ÿæˆç”»é¢**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä¸€æ™‚çš„ãªã‚»ã‚¯ã‚·ãƒ§ãƒ³IDï¼ˆUUIDï¼‰ã‚’ç”Ÿæˆ
2. **è¨˜äº‹ä½œæˆAPIå‘¼ã³å‡ºã—**: ã“ã®ä¸€æ™‚IDã‚’å«ã‚€ã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’é€ä¿¡
3. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜**: SupabaseãŒæ–°ã—ã„IDï¼ˆUUIDï¼‰ã‚’è‡ªå‹•ç”Ÿæˆã—ã¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä¿å­˜
4. **APIãƒ¬ã‚¹ãƒãƒ³ã‚¹**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ï¼ˆæ–°ã—ã„IDã‚’å«ã‚€ï¼‰ã‚’è¿”ã•ãªã„
5. **åŸ·ç­†ç”»é¢**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¯å¤ã„ä¸€æ™‚IDã‚’ä½¿ç”¨
6. **è‡ªå‹•ä¿å­˜**: å­˜åœ¨ã—ãªã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã§æ›´æ–°ã—ã‚ˆã†ã¨ã—ã¦ã‚¨ãƒ©ãƒ¼

## ä¿®æ­£å†…å®¹

### 1. è¨˜äº‹ä½œæˆAPIã®ä¿®æ­£ï¼ˆ`app/api/articles/route.ts`ï¼‰

ã‚»ã‚¯ã‚·ãƒ§ãƒ³æŒ¿å…¥æ™‚ã« `.select()` ã‚’è¿½åŠ ã—ã€ä½œæˆã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ï¼ˆå®Ÿéš›ã®IDã‚’å«ã‚€ï¼‰ã‚’å–å¾—ã—ã¦è¿”ã™ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```typescript
// ä¿®æ­£å‰
const { error: sectionsError } = await supabase
  .from('article_sections')
  .insert(sections)

// ä¿®æ­£å¾Œ
const { data: sectionsData, error: sectionsError } = await supabase
  .from('article_sections')
  .insert(sections)
  .select()  // â† ä½œæˆã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—
```

ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’è¿½åŠ ï¼š

```typescript
return NextResponse.json({
  success: true,
  article: {
    id: article.id,
    // ... ä»–ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
    outline: createdSections.map((section: any) => ({
      id: section.id,  // â† ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒç”Ÿæˆã—ãŸå®Ÿéš›ã®ID
      section: section.section_number,
      title: section.title,
      description: section.description,
      content: section.content,
      wordCount: section.word_count,
      isCompleted: section.is_completed
    }))
  }
})
```

### 2. è¨˜äº‹ã‚µãƒ¼ãƒ“ã‚¹ã®å‹å®šç¾©ä¿®æ­£ï¼ˆ`lib/article-service.ts`ï¼‰

`createArticle` ã®è¿”ã‚Šå€¤ã‚’ `Article` ã‹ã‚‰ `ArticleDetail` ã«å¤‰æ›´ã—ã€`outline` ã‚’å«ã‚€ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```typescript
// ä¿®æ­£å‰
export async function createArticle(data: CreateArticleData): Promise<{ 
  success: boolean; 
  article?: Article;  // outline ã‚’å«ã¾ãªã„
  error?: string 
}>

// ä¿®æ­£å¾Œ
export async function createArticle(data: CreateArticleData): Promise<{ 
  success: boolean; 
  article?: ArticleDetail;  // outline ã‚’å«ã‚€
  error?: string 
}>
```

### 3. åŸ·ç­†ç”»é¢ã®ä¿®æ­£ï¼ˆ`app/writing/page.tsx`ï¼‰

è¨˜äº‹ä½œæˆå¾Œã€è¿”ã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’ä½¿ã£ã¦ã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã—ãŸã€‚

```typescript
// è¨˜äº‹ä½œæˆå¾Œ
if (articleResult.success && articleResult.article) {
  setArticleId(articleResult.article.id)
  
  // ä½œæˆã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ã‚’å–å¾—ï¼ˆå®Ÿéš›ã®IDã‚’å«ã‚€ï¼‰
  const createdSections = articleResult.article.outline || []
  
  // ãƒ‘ãƒ¼ã‚¹ã•ã‚ŒãŸã‚¢ã‚¦ãƒˆãƒ©ã‚¤ãƒ³ã‚’ã€ä½œæˆã•ã‚ŒãŸã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã§æ›´æ–°
  const updatedOutline = parsedOutline.map((section: any, index: number) => ({
    ...section,
    id: createdSections[index]?.id || section.id  // â† å®Ÿéš›ã®IDã«ç½®ãæ›ãˆ
  }))
  setOutline(updatedOutline)
  
  // ä»¥é™ã€updatedOutline ã‚’ä½¿ç”¨
  for (let i = 0; i < updatedOutline.length; i++) {
    const section = updatedOutline[i]  // â† æ­£ã—ã„IDã‚’æŒã¤ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    // ...
  }
}
```

## ç¢ºèªæ‰‹é †

1. **ãƒ–ãƒ©ã‚¦ã‚¶ã‚’æ›´æ–°**
   - `F5` ã¾ãŸã¯ `Ctrl+R`

2. **æ–°è¦è¨˜äº‹ä½œæˆ**
   - ã€Œæ–°è¦ä½œæˆã€â†’ ãƒ†ãƒ¼ãƒå…¥åŠ› â†’ è¦‹å‡ºã—é¸æŠ â†’ ç›®æ¬¡ç”Ÿæˆ â†’ ã€ŒåŸ·ç­†ã‚’é–‹å§‹ã™ã‚‹ã€

3. **è‡ªå‹•ä¿å­˜ã®ãƒ†ã‚¹ãƒˆ**
   - åŸ·ç­†ç”»é¢ã§ãƒ†ã‚­ã‚¹ãƒˆã‚’ç·¨é›†
   - 2ç§’å¾…ã¤
   - ç”»é¢ä¸Šéƒ¨ã«ã€Œä¿å­˜ã—ã¾ã—ãŸã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
   - ã‚¨ãƒ©ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚’ç¢ºèª

4. **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç¢ºèªï¼ˆä»»æ„ï¼‰**
   - Supabase Dashboard ã® Table Editor ã§ `article_sections` ã‚’é–‹ã
   - `content` ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæ›´æ–°ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèª

## å½±éŸ¿ç¯„å›²

### ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«
- `blog-writer-app/app/api/articles/route.ts`
- `blog-writer-app/lib/article-service.ts`
- `blog-writer-app/app/writing/page.tsx`

### å½±éŸ¿ã‚’å—ã‘ã‚‹æ©Ÿèƒ½
- âœ… è¨˜äº‹ä½œæˆï¼ˆæ–°è¦è¨˜äº‹ã®ä½œæˆæ™‚ã«ã‚»ã‚¯ã‚·ãƒ§ãƒ³æƒ…å ±ãŒè¿”ã•ã‚Œã‚‹ï¼‰
- âœ… è‡ªå‹•ä¿å­˜ï¼ˆæ­£ã—ã„ã‚»ã‚¯ã‚·ãƒ§ãƒ³IDã§ä¿å­˜ã§ãã‚‹ï¼‰
- âœ… æ‰‹å‹•ä¿å­˜ï¼ˆåŒæ§˜ã«æ­£ã—ã„IDã‚’ä½¿ç”¨ï¼‰

### å½±éŸ¿ã‚’å—ã‘ãªã„æ©Ÿèƒ½
- è¨˜äº‹ä¸€è¦§å–å¾—
- è¨˜äº‹è©³ç´°å–å¾—
- è¨˜äº‹æ›´æ–°
- è¨˜äº‹å‰Šé™¤
- ã‚»ã‚¯ã‚·ãƒ§ãƒ³å‰Šé™¤

## æŠ€è¡“çš„ãªãƒã‚¤ãƒ³ãƒˆ

1. **IDã®ç®¡ç†**: ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã§ä¸€æ™‚çš„ãªIDã‚’ç”Ÿæˆã™ã‚‹å ´åˆã€ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§æ°¸ç¶šåŒ–ã•ã‚ŒãŸIDã«ç½®ãæ›ãˆã‚‹å¿…è¦ãŒã‚ã‚‹
2. **APIãƒ¬ã‚¹ãƒãƒ³ã‚¹**: ä½œæˆç³»ã®APIã¯ã€ä½œæˆã•ã‚ŒãŸãƒªã‚½ãƒ¼ã‚¹ã®å®Œå…¨ãªæƒ…å ±ï¼ˆè‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸIDã‚’å«ã‚€ï¼‰ã‚’è¿”ã™ã¹ã
3. **å‹å®‰å…¨æ€§**: TypeScriptã®å‹å®šç¾©ã‚’é©åˆ‡ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ã“ã®ã‚ˆã†ãªå•é¡Œã‚’æ—©æœŸã«ç™ºè¦‹ã§ãã‚‹

## ä»Šå¾Œã®æ”¹å–„æ¡ˆ

1. **ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æ”¹å–„**: ã‚»ã‚¯ã‚·ãƒ§ãƒ³ãŒè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ã‚ˆã‚Šè©³ç´°ã«ã™ã‚‹
2. **ãƒªãƒˆãƒ©ã‚¤æ©Ÿèƒ½**: è‡ªå‹•ä¿å­˜å¤±æ•—æ™‚ã«è‡ªå‹•çš„ã«ãƒªãƒˆãƒ©ã‚¤ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ 
3. **ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ**: ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¨ãƒ©ãƒ¼æ™‚ã«ãƒ­ãƒ¼ã‚«ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ä¸€æ™‚ä¿å­˜ã™ã‚‹æ©Ÿèƒ½ã‚’è¿½åŠ 

---

**ä¿®æ­£æ—¥**: 2025å¹´11æœˆ13æ—¥  
**ä¿®æ­£è€…**: AI Assistant  
**ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 1.0

